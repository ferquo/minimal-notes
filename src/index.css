@import "tailwindcss";

/* Use class-based dark mode in Tailwind v4 */
@custom-variant dark (&:where(.dark, .dark *));

/* Tell Tailwind where to scan for class names (v4) */
@source "../index.html";
@source "./**/*.{js,jsx,ts,tsx}";

/* Optional: light theming tokens */
@theme {
  --font-sans: ui-sans-serif, system-ui, -apple-system, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "JetBrains Mono", "Fira Code", "Source Code Pro", "Courier New", monospace;
}

/* App scaffolding helpers */
:root {
  color-scheme: light;
  /* Responsive toolbar/header height: grows slightly with viewport size */
  --toolbar-h: clamp(44px, 4.2vh, 56px);
}

html, body, #root {
  height: 100%;
}

/* Ensure no default page margins */
body {
  margin: 0;
  font-family: var(--font-sans);
}

/* Dark mode root behavior */
.dark {
  color-scheme: dark;
}

/* Prose and code block tuning */
.prose {
  --tw-prose-body: theme(colors.slate.800);
  --tw-prose-headings: theme(colors.slate.900);
  --tw-prose-links: theme(colors.indigo.700);
  --tw-prose-bullets: theme(colors.slate.400);
}
.dark .prose {
  --tw-prose-body: theme(colors.slate.200);
  --tw-prose-headings: theme(colors.slate.100);
  --tw-prose-links: theme(colors.indigo.400);
  --tw-prose-bullets: theme(colors.slate.500);
}

.prose pre {
  @apply bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg p-4 overflow-x-auto;
}

.prose code {
  @apply font-mono text-[0.95em];
}

.prose :not(pre) > code {
  @apply bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded border border-slate-200/60 dark:border-slate-700/60;
}

.prose blockquote {
  @apply border-l-4 border-slate-300 dark:border-slate-700 pl-4 italic text-slate-600 dark:text-slate-300;
}

/* Fallback list styling in case typography plugin isn't active */
.ProseMirror ul {
  list-style: disc;
  padding-left: 1.5rem; /* pl-6 */
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
.ProseMirror ol {
  list-style: decimal;
  padding-left: 1.5rem; /* pl-6 */
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
.ProseMirror li { margin: 0.25em 0; }

/* Make TipTap editor fill the container */
.ProseMirror {
  min-height: 100%;
}

/* Remove any focus outlines/borders on the editable area */
.ProseMirror,
.ProseMirror:focus,
.ProseMirror-focused {
  outline: none !important;
  box-shadow: none !important;
  border: 0 !important;
}

/* Fallback heading styles inside the editor in case typography plugin doesn't apply */
.ProseMirror h1 {
  font-size: 1.875rem; /* text-3xl */
  line-height: 2.25rem;
  font-weight: 700;
  margin-top: 1.25em;
  margin-bottom: 0.6em;
}

.ProseMirror h2 {
  font-size: 1.5rem; /* text-2xl */
  line-height: 2rem;
  font-weight: 700;
  margin-top: 1.1em;
  margin-bottom: 0.5em;
}

.ProseMirror h3 {
  font-size: 1.25rem; /* text-xl */
  line-height: 1.75rem;
  font-weight: 600;
  margin-top: 1em;
  margin-bottom: 0.4em;
}

.ProseMirror p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

/* Fallback inline code styling */
.ProseMirror :not(pre) > code {
  font-family: var(--font-mono);
  background: rgb(241 245 249); /* slate-100 */
  color: inherit;
  padding: 0.125rem 0.375rem; /* px-1.5 py-0.5 */
  border-radius: 0.25rem; /* rounded */
  border: 1px solid rgba(203, 213, 225, 0.6); /* slate-200/60 */
}
.dark .ProseMirror :not(pre) > code {
  background: rgb(30 41 59); /* slate-800 */
  border-color: rgba(51, 65, 85, 0.6); /* slate-700/60 */
}

/* Image rendering and resize handles */
.ProseMirror img {
  max-width: 100%;
  height: auto;
}

/* Clear visual affordance for links inside the editor */
.ProseMirror a {
  color: rgb(37 99 235); /* blue-600 */
  text-decoration: underline;
  text-underline-offset: 2px;
  cursor: pointer;
}
.ProseMirror a:hover {
  color: rgb(29 78 216); /* blue-700 */
}
.dark .ProseMirror a {
  color: rgb(96 165 250); /* blue-400 */
}
.dark .ProseMirror a:hover {
  color: rgb(59 130 246); /* blue-500 */
}

.ProseMirror .image-node {
  position: relative;
  display: inline-block;
  color: rgba(99, 102, 241, 0.9); /* indigo handle */
}

.ProseMirror .image-node.is-selected img,
.ProseMirror .image-node.is-dragging img {
  outline: 2px solid rgba(99, 102, 241, 0.4);
  outline-offset: 2px;
}

.ProseMirror .image-node:hover .image-resize-handle,
.ProseMirror .image-node.is-selected .image-resize-handle {
  opacity: 0.8 !important;
}
